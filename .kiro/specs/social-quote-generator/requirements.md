# Requirements Document

## Introduction

This feature aims to create an automated Python tool that generates visually appealing images from BGE (Brigata dei Geek Estinti) episode quotes and publishes them to social media platforms. The tool will extract quotes from existing episode data, create branded images with those quotes, and automate the posting process to various social media channels.

The BGE podcast currently has quotes generated by different AI models (Claude, OpenAI, DeepSeek, Llama) stored in text files and episode metadata. This tool will leverage these quotes to create engaging social media content that promotes episodes and increases audience engagement.

## Requirements

### Requirement 1: Quote Extraction and Management

**User Story:** As a content manager, I want to extract quotes from BGE episode files, so that I can use them for social media content generation.

#### Acceptance Criteria

1. WHEN the tool is executed THEN it SHALL read episode metadata from the `_episodes` directory
2. WHEN processing episode files THEN it SHALL extract quotes from both YAML frontmatter (quote_claude, quote_openai, quote_deepseek, quote_llama) AND separate text files in `assets/texts/`
3. WHEN multiple quote sources exist for an episode THEN it SHALL support selecting a specific quote source or randomly choosing one
4. WHEN quote data is missing or malformed THEN it SHALL log a warning and skip that episode gracefully
5. IF an episode number is specified THEN it SHALL extract quotes only for that episode
6. WHEN extracting quotes THEN it SHALL also capture associated metadata (episode number, title, guests, date)

### Requirement 2: Image Generation

**User Story:** As a content manager, I want to generate branded images with episode quotes, so that I can create visually consistent social media posts.

#### Acceptance Criteria

1. WHEN generating an image THEN it SHALL create an image with configurable dimensions (default 1080x1080 for Instagram, 1200x675 for Twitter/Facebook)
2. WHEN rendering the quote THEN it SHALL use a readable font with proper text wrapping and alignment
3. WHEN creating the image THEN it SHALL include the BGE branding elements (logo, colors, style)
4. WHEN the quote is too long THEN it SHALL automatically adjust font size or truncate with ellipsis
5. WHEN generating an image THEN it SHALL overlay episode metadata (episode number, guest names) in a non-intrusive way
6. WHEN an image is created THEN it SHALL save it to a configurable output directory with a naming convention like `bge_{episode_number}_{platform}_{timestamp}.png`
7. IF a background image or template is provided THEN it SHALL use it as the base for the quote overlay
8. WHEN rendering text THEN it SHALL support Italian language characters and special symbols

### Requirement 3: Social Media Publishing

**User Story:** As a content manager, I want to automatically publish generated quote images to social media platforms, so that I can maintain consistent posting without manual intervention.

#### Acceptance Criteria

1. WHEN publishing is enabled THEN it SHALL support posting to at least one social media platform (Twitter/X, Instagram, Facebook, or LinkedIn)
2. WHEN posting to a platform THEN it SHALL use platform-specific API credentials stored securely in environment variables or configuration files
3. WHEN creating a post THEN it SHALL include the generated image and a caption with episode information
4. WHEN generating captions THEN it SHALL include relevant hashtags (e.g., #BGE, #DevOps, #IT, episode-specific tags)
5. WHEN posting fails THEN it SHALL log the error with details and continue processing other episodes
6. IF dry-run mode is enabled THEN it SHALL generate images and captions without actually posting
7. WHEN a post is successful THEN it SHALL log the post URL and timestamp
8. WHEN rate limits are encountered THEN it SHALL implement exponential backoff and retry logic

### Requirement 4: Configuration and Customization

**User Story:** As a content manager, I want to configure the tool's behavior through a configuration file, so that I can customize it without modifying code.

#### Acceptance Criteria

1. WHEN the tool starts THEN it SHALL read configuration from a YAML or JSON file (e.g., `config.yaml`)
2. WHEN configuration is missing THEN it SHALL use sensible defaults and create a sample configuration file
3. WHEN configuring image generation THEN it SHALL allow customization of dimensions, fonts, colors, logo placement, and background
4. WHEN configuring social media THEN it SHALL allow enabling/disabling specific platforms and setting platform-specific options
5. WHEN configuring quote selection THEN it SHALL allow specifying preferred AI source (claude, openai, deepseek, llama) or random selection
6. WHEN configuring output THEN it SHALL allow specifying output directories for images and logs
7. IF template files are specified THEN it SHALL validate their existence and format

### Requirement 5: Command-Line Interface

**User Story:** As a content manager, I want to run the tool from the command line with various options, so that I can control its behavior for different use cases.

#### Acceptance Criteria

1. WHEN running the tool THEN it SHALL provide a CLI with clear help documentation
2. WHEN invoked with `--episode N` THEN it SHALL process only episode N
3. WHEN invoked with `--episodes N,M,P` THEN it SHALL process multiple specified episodes
4. WHEN invoked with `--all` THEN it SHALL process all available episodes
5. WHEN invoked with `--platform PLATFORM` THEN it SHALL generate images only for the specified platform
6. WHEN invoked with `--dry-run` THEN it SHALL generate images without publishing
7. WHEN invoked with `--publish` THEN it SHALL publish to configured social media platforms
8. WHEN invoked with `--config PATH` THEN it SHALL use the specified configuration file
9. WHEN invoked with `--output-dir PATH` THEN it SHALL save generated images to the specified directory
10. WHEN invoked with `--quote-source SOURCE` THEN it SHALL use quotes from the specified AI source

### Requirement 6: Error Handling and Logging

**User Story:** As a content manager, I want comprehensive logging and error handling, so that I can troubleshoot issues and monitor the tool's operation.

#### Acceptance Criteria

1. WHEN the tool runs THEN it SHALL log all operations to both console and a log file
2. WHEN an error occurs THEN it SHALL log the error with context (episode number, operation, stack trace)
3. WHEN processing multiple episodes THEN it SHALL continue processing after non-fatal errors
4. WHEN a fatal error occurs THEN it SHALL exit gracefully with a clear error message and non-zero exit code
5. WHEN logging THEN it SHALL support different log levels (DEBUG, INFO, WARNING, ERROR)
6. WHEN the tool completes THEN it SHALL provide a summary of processed episodes, generated images, and published posts
7. IF API credentials are invalid THEN it SHALL detect this early and provide clear guidance

### Requirement 7: Dependencies and Installation

**User Story:** As a developer, I want clear installation instructions and dependency management, so that I can set up the tool easily.

#### Acceptance Criteria

1. WHEN installing THEN it SHALL provide a `requirements.txt` file with all Python dependencies
2. WHEN dependencies include image processing THEN it SHALL use Pillow (PIL) for image manipulation
3. WHEN dependencies include social media APIs THEN it SHALL use official or well-maintained libraries (e.g., tweepy for Twitter, instagrapi for Instagram)
4. WHEN installing THEN it SHALL include a README with setup instructions, API credential configuration, and usage examples
5. WHEN Python version requirements exist THEN it SHALL specify minimum Python version (3.8+)
6. IF system dependencies are required THEN it SHALL document them clearly
